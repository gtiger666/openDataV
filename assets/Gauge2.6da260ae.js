import{V as b,W as g}from"./echarts.b68702ec.js";import{a as x}from"./@vueuse.f12362bf.js";import{h as N}from"./index.59cf4f9c.js";import{c as j,u as C}from"./index.8c99d488.js";import{t as w}from"./mydark.8efe4250.js";import{d as S}from"./lodash-es.ef547d44.js";import{p as L,r as c,q as k,w as z,c as y,o as A,y as O,x as T}from"./@vue.93899e90.js";import"./zrender.aa8f9b3b.js";import"./tslib.34a40861.js";import"./axios.19d3e859.js";import"./vue-router.62208e1c.js";import"./pinia.7738838c.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./element-plus.da7f9641.js";import"./lodash.1a3e162a.js";import"./nprogress.5f640c6a.js";import"./async-validator.5d25c98b.js";import"./@popperjs.a8a4a6a0.js";import"./resize-observer-polyfill.8deb1e21.js";const $=L({props:{element:null,propValue:null},setup(m){const e=m;b("mydark",w);const d=j(),s=c(null);let a=null;const i=c(0);k(()=>{h(),V()}),x(s,o=>{const l=o[0],{width:r,height:u}=l.contentRect;a==null||a.resize({width:r,height:u})});const n=()=>{const o={series:[{type:"gauge",min:e.propValue.minValue,max:e.propValue.maxValue,splitNumber:t.value.splitNumber,axisLine:{lineStyle:{width:t.value.axisLine.width,color:t.value.axisLine.color}},pointer:{icon:t.value.pointer.icon,showAbove:!1,length:t.value.pointer.length,width:t.value.pointer.width,offsetCenter:t.value.pointer.offsetCenter,itemStyle:{color:t.value.pointer.color||"auto"}},axisTick:{length:t.value.axisTick.length,lineStyle:{color:t.value.axisTick.color||"auto",width:t.value.axisTick.width}},splitLine:{length:t.value.splitLine.length,lineStyle:{color:t.value.splitLine.color||"auto",width:t.value.splitLine.width}},axisLabel:{show:t.value.axisLabel.show,color:t.value.axisLabel.color||"auto",fontSize:t.value.axisLabel.fontSize,distance:t.value.axisLabel.distance},title:{offsetCenter:t.value.title.offsetCenter,fontSize:t.value.title.fontSize,color:t.value.title.color},detail:{fontSize:t.value.detail.fontSize,offsetCenter:t.value.detail.offsetCenter,valueAnimation:!0,formatter:function(l){return l+t.value.detail.unit},color:t.value.detail.color||"auto"},data:[{value:i.value,name:e.propValue.title}]}]};return t.value.startAngle!==t.value.endAngle&&(o.series[0].startAngle=t.value.startAngle,o.series[0].endAngle=t.value.endAngle),o},f=o=>{const l=o;e.propValue.datatag===l.TagName&&(i.value=Number(l.TagValue),p())},p=S(()=>{const o=n();o.series[0].data[0].value=i.value,a&&a.setOption({series:o.series})},300),h=()=>{N.post({url:e.propValue.history,data:[e.propValue.datatag]}).then(o=>{o.ErrorCode===200&&(i.value=Number(o.Results[0].TagValue))}).catch(o=>{console.log(o);const l=e.propValue.maxValue;d.isEditMode&&(i.value=Math.round(Math.random()*l))}).finally(()=>{p()})},V=()=>{a=g(s.value,"mydark"),a.clear(),a.setOption(n())};z(()=>e.propValue,(o,l)=>{console.log(o),a&&(a.clear(),a.setOption(n()))},{deep:!0});const t=y(()=>({startAngle:Number(e.propValue.startAngle),endAngle:Number(e.propValue.endAngle),minValue:Number(e.propValue.minValue),maxValue:Number(e.propValue.maxValue),splitNumber:Number(e.propValue.splitNumber),axisLine:{width:Number(e.propValue.axisWidth),color:v()},pointer:{width:Number(e.propValue.pointerWidth),color:e.propValue.pointerColor,length:e.propValue.pointerLength,offsetCenter:e.propValue.pointerOffset.split(","),icon:e.propValue.pointStyle},axisLabel:{show:e.propValue.tickShow,color:e.propValue.tickFontColor,fontSize:Number(e.propValue.tickFontSize),distance:Number(e.propValue.tickDistance)},title:{offsetCenter:e.propValue.titleOffset.split(","),fontSize:Number(e.propValue.titleFontSize),color:e.propValue.titleColor},detail:{fontSize:Number(e.propValue.detailFontSize),offsetCenter:e.propValue.detailOffset.split(","),color:e.propValue.detailFontColor,unit:e.propValue.unit},splitLine:{length:Number(e.propValue.splitLength),color:e.propValue.splitColor,width:Number(e.propValue.splitWidth)},axisTick:{length:Number(e.propValue.tickLength),color:e.propValue.tickColor,width:Number(e.propValue.tickWidth)}})),v=()=>e.propValue.axisColor.split(";").map(o=>{const l=o.split(",");return[Number(l[0]),l[1]]});return C("actual",f),A(()=>{a&&(a.clear(),a.dispose())}),(o,l)=>(T(),O("div",{ref:(r,u)=>{u.chartEl=r,s.value=r}},null,512))}});export{$ as default};
