var _=(g,t,i)=>new Promise((c,n)=>{var d=s=>{try{p(i.next(s))}catch(y){n(y)}},b=s=>{try{p(i.throw(s))}catch(y){n(y)}},p=s=>s.done?c(s.value):Promise.resolve(s.value).then(d,b);p((i=i.apply(g,t)).next())});import{a as H}from"./@vueuse.f12362bf.js";import{h as F}from"./index.59cf4f9c.js";import{_ as P,f as N,u as G}from"./index.8c99d488.js";import{p as T,r as f,q as L,c as l,y as m,B as v,F as W,a6 as $,u as r,H as O,I as w,x as h}from"./@vue.93899e90.js";import"./axios.19d3e859.js";import"./vue-router.62208e1c.js";import"./pinia.7738838c.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./element-plus.da7f9641.js";import"./lodash.1a3e162a.js";import"./nprogress.5f640c6a.js";import"./async-validator.5d25c98b.js";import"./@popperjs.a8a4a6a0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./lodash-es.ef547d44.js";const q=["id"],M=["offset","stop-color"],X=["id","x2"],A=["offset","stop-color"],J=["x","y","rx","ry","stroke-width","stroke","width","height"],K=["stroke-width","stroke-dasharray","stroke","points"],Q=["stroke","fill","x","y"],U=T({props:{element:null,propValue:null},setup(g){const t=g,i=f(null),c=f(150),n=f(150),d=f(60),b=f(`percent-pond-gradientId1-${N()}`),p=f(`percent-pond-gradientId2-${N()}`);H(i,o=>{const a=o[0].contentRect;c.value=a.width,n.value=a.height});const s=o=>{const u=o;t.propValue.datatag&&u.TagName===t.propValue.datatag&&(d.value=Number((Number(u.TagValue)*100/Number(t.propValue.maxValue)).toFixed(2)))};L(()=>_(this,null,function*(){yield y()}));const y=()=>_(this,null,function*(){if(t.propValue.history)try{const o=yield F.post({url:t.propValue.history,data:[t.propValue.datatag]});o.ErrorCode===200&&(d.value=(Number(o.Results[0].TagValue)||0)*100/Number(t.propValue.maxValue))}catch(o){console.log(o.message||o)}}),e=l(()=>({colors:[t.propValue.color1,t.propValue.color1],borderWidth:Number(t.propValue.borderWidth),borderGap:Number(t.propValue.borderGap),lineDash:t.propValue.lineDash.split(",").map(o=>Number(o)),textColor:t.propValue.textColor,fontSize:Number(t.propValue.fontSize),borderRadius:Number(t.propValue.borderRadius),localGradient:Boolean(t.propValue.localGradient),formatter:t.propValue.formatter})),z=l(()=>({transform:`rotate(${t.propValue.rotate}deg)`})),V=l(()=>e.value?c.value-e.value.borderWidth:0),j=l(()=>e.value?n.value-e.value.borderWidth:0),S=l(()=>e.value?n.value-(e.value.borderWidth+e.value.borderGap)*2:0),C=l(()=>e.value&&e.value.localGradient?b.value:p.value),R=l(()=>{const o=n.value/2;if(!e.value)return`0, ${o} 0, ${o}`;const u=(c.value-(e.value.borderWidth+e.value.borderGap)*2)/100*d.value;return`
        ${e.value.borderWidth+e.value.borderGap}, ${o}
        ${e.value.borderWidth+e.value.borderGap+u}, ${o+.001}`}),k=l(()=>{if(!e.value)return[];const o=e.value.colors.length,u=100/(o-1);return e.value.colors.map((a,x)=>[u*x,a])}),B=l(()=>e.value?"200%":"100%"),I=l(()=>e.value.formatter?e.value.formatter.replace("{value}",d.value.toString()):""),D=l(()=>({fontSize:(t.propValue.fontSize||12)+"px"})),E=o=>{o.key==="maxValue"&&(d.value=Number((Number(o.value)*100/Number(t.propValue.maxValue)).toFixed(2)))};return G(t.element.component+t.element.id,E),G("actual",s),(o,u)=>(h(),m("div",{class:"dv-percent-pond",ref:(a,x)=>{x.mainEl=a,i.value=a},style:w(r(z))},[(h(),m("svg",null,[v("defs",null,[v("linearGradient",{id:b.value,x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[(h(!0),m(W,null,$(r(k),a=>(h(),m("stop",{key:a[0],offset:`${a[0]}%`,"stop-color":a[1]},null,8,M))),128))],8,q),v("linearGradient",{id:p.value,x1:"0%",y1:"0%",x2:r(B),y2:"0%"},[(h(!0),m(W,null,$(r(k),a=>(h(),m("stop",{key:a[0],offset:`${a[0]}%`,"stop-color":a[1]},null,8,A))),128))],8,X)]),v("rect",{x:r(e)?r(e).borderWidth/2:"0",y:r(e)?r(e).borderWidth/2:"0",rx:r(e)?r(e).borderRadius:"0",ry:r(e)?r(e).borderRadius:"0",fill:"transparent","stroke-width":r(e)?r(e).borderWidth:"0",stroke:`url(#${b.value})`,width:r(V)>0?r(V):0,height:r(j)>0?r(j):0},null,8,J),v("polyline",{"stroke-width":r(S),"stroke-dasharray":r(e)?r(e).lineDash.join(","):"0",stroke:`url(#${r(C)})`,points:r(R)},null,8,K),v("text",{style:w(r(D)),stroke:r(e)?r(e).textColor:"#fff",fill:r(e)?r(e).textColor:"#fff",x:c.value/2,y:n.value/2},O(r(I)),13,Q)]))],4))}});var ve=P(U,[["__scopeId","data-v-5266c9fe"]]);export{ve as default};
