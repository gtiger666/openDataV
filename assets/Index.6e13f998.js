var Lt=Object.defineProperty,Mt=Object.defineProperties;var It=Object.getOwnPropertyDescriptors;var ut=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable,Ce=Math.pow,it=(e,n,t)=>n in e?Lt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,pe=(e,n)=>{for(var t in n||(n={}))jt.call(n,t)&&it(e,t,n[t]);if(ut)for(var t of ut(n))Vt.call(n,t)&&it(e,t,n[t]);return e},Ge=(e,n)=>Mt(e,It(n));var xe=(e,n,t)=>new Promise((s,d)=>{var a=c=>{try{i(t.next(c))}catch(u){d(u)}},p=c=>{try{i(t.throw(c))}catch(u){d(u)}},i=c=>c.done?s(c.value):Promise.resolve(c.value).then(a,p);i((t=t.apply(e,n)).next())});import{p as U,P as le,Q as se,x as h,y as E,B as D,F as R,I as oe,ar as Bt,r as w,_ as Y,a6 as W,u as o,E as me,aq as ct,c as N,a1 as At,as as Rt,q as Ee,w as ye,H as ue,A as rt,G as he,n as Pt,o as Be,U as g,M as $,O as _,S as Ut,b as dt,Z as pt,a0 as X,z as qe,am as Nt,an as zt,R as Tt}from"./@vue.93899e90.js";import{c as z,M as ge,s as Ae,k as Re,_ as T,l as Je,u as Pe,m as Ue,o as we,p as P,q as Ot,r as Wt,i as Ne,t as Ht,v as Ke,x as mt,h as Xt,j as Yt,y as Me,a as Gt,w as qt,z as Qe,B as Jt,D as Kt,F as _e,G as Qt,H as ht,I as Zt,J as Q}from"./index.8c99d488.js";import{d as ze}from"./pinia.7738838c.js";import{c as Fe,d as ft}from"./lodash-es.ef547d44.js";import{b as Te,o as Oe}from"./@vueuse.f12362bf.js";import{u as en,d as vt}from"./vue-router.62208e1c.js";import{u as tn,s as nn,g as on}from"./index.1127d831.js";import{a as an}from"./index.59cf4f9c.js";import{h as yt,i as gt,j as ln,k as Ie,l as q,m as We,n as be,o as Se,p as sn,q as Ze,r as un,s as et,t as He,u as tt,v as nt,w as cn,x as rn,c as dn,y as je,z as _t,A as Ct,B as xt,C as bt,D as St,F as wt,G as Dt}from"./element-plus.da7f9641.js";import"./mitt.550594b0.js";import"./nprogress.5f640c6a.js";import"./vue-demi.b3a9cad9.js";import"./lodash.1a3e162a.js";import"./async-validator.5d25c98b.js";import"./@popperjs.a8a4a6a0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./axios.19d3e859.js";const pn=ze({id:"copy",state:()=>({copyData:void 0,isCut:!1}),actions:{copy(){const e=z();!e.curComponent||(this.copyData={data:Fe(e.curComponent),index:e.curComponentIndex})},paste(e,n,t){if(!this.copyData){ge("\u8BF7\u9009\u62E9\u7EC4\u4EF6");return}const s=z(),d=this.copyData.data;e?(d.style.top=t,d.style.left=n):(d.style.top+=10,d.style.left+=10),s.copyComponent(Fe(d)),this.isCut&&(this.copyData=void 0)},cut(){const e=z();if(!e.curComponent){ge("\u8BF7\u9009\u62E9\u7EC4\u4EF6");return}if(this.copyData){const n=Fe(this.copyData.data),t=this.copyData.index;e.addComponent({component:n,index:t}),t!==void 0&&e.curComponentIndex&&e.curComponentIndex>=t&&e.curComponentIndex++}this.copy(),e.deleteComponent(void 0),this.isCut=!0}}});function mn(){return pn(Ae)}const hn=ze({id:"snapshot",state:()=>({snapshotData:[],snapshotMax:5}),actions:{undo(){const e=z(),n=this.snapshotData.pop();n&&e.setComponentData(n)},recordSnapshot(){const e=z();this.snapshotData.length>=this.snapshotMax&&this.snapshotData.shift(),this.snapshotData.push(Fe(e.componentData))},clearSnapshot(){this.snapshotData=[]}}});function Ve(){return hn(Ae)}const fn=ze({id:"layer",actions:{upComponent(){const e=z(),n=e.curComponentIndex;n<e.componentData.length-1?Re(e.componentData,n,n+1):ge("\u5DF2\u7ECF\u5230\u9876\u4E86")},downComponent(){const e=z(),n=e.curComponentIndex;n>0?Re(e.componentData,n,n-1):ge("\u5DF2\u7ECF\u5230\u5E95\u4E86")},bottomComponent(){const e=z(),n=e.componentData,t=e.curComponentIndex;if(t>0){const s=n.splice(t,1);n.unshift(s[0])}else ge("\u5DF2\u7ECF\u5230\u5E95\u4E86")},topComponent(){const e=z(),n=e.componentData,t=e.curComponentIndex;if(t<n.length-1){const s=n.splice(t,1);n.push(s[0])}else ge("\u5DF2\u7ECF\u5230\u9876\u4E86")}}});function vn(){return fn(Ae)}const yn=U({props:{display:null,menuTop:null,menuLeft:null,curComponent:null},emits:["update:display"],setup(e,{emit:n}){const t=e,s=z(),d=mn(),a=Ve(),p=vn(),i=()=>{s.setClickComponentStatus(!0)},c=()=>{d.cut(),n("update:display",!1)},u=()=>{d.copy(),n("update:display",!1)},r=()=>{a.recordSnapshot(),d.paste(!0,t.menuLeft-258,t.menuTop-82),n("update:display",!1)},m=()=>{a.recordSnapshot(),s.deleteComponent(),n("update:display",!1)},l=()=>{a.recordSnapshot(),p.upComponent(),n("update:display",!1)},v=()=>{a.recordSnapshot(),p.downComponent(),n("update:display",!1)},f=()=>{a.recordSnapshot(),p.topComponent(),n("update:display",!1)},C=()=>{if(t.curComponent){let A=t.curComponent.id;Je(A)}n("update:display",!1)},k=()=>{p.bottomComponent(),a.recordSnapshot(),n("update:display",!1)};return(A,I)=>le((h(),E("div",{class:"contextmenu",style:oe({top:e.menuTop+"px",left:e.menuLeft+"px"})},[D("ul",{onMouseup:i},[e.curComponent?(h(),E(R,{key:0},[D("li",{onClick:u},"\u590D\u5236"),D("li",{onClick:r},"\u7C98\u8D34"),D("li",{onClick:c},"\u526A\u5207"),D("li",{onClick:m},"\u5220\u9664"),D("li",{onClick:f},"\u7F6E\u9876"),D("li",{onClick:k},"\u7F6E\u5E95"),D("li",{onClick:l},"\u4E0A\u4E00\u5C42"),D("li",{onClick:v},"\u4E0B\u4E00\u5C42"),D("li",{onClick:C},"\u590D\u5236ID")],64)):(h(),E("li",{key:1,onClick:r},"\u7C98\u8D34"))],32)],4)),[[se,e.display]])}});var gn=T(yn,[["__scopeId","data-v-5fe26b70"]]);const _n=U({props:{start:null,width:null,height:null},setup(e){return(n,t)=>(h(),E("div",{style:oe({left:e.start.x+"px",top:e.start.y+"px",width:e.width+"px",height:e.height+"px"}),class:"area"},null,4))}});var Cn=T(_n,[["__scopeId","data-v-742be9d2"]]);const xn={},bn={class:"grid",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},Sn=Bt('<defs data-v-22c0fba1><pattern id="smallGrid" width="7.236328125" height="7.236328125" patternUnits="userSpaceOnUse" data-v-22c0fba1><path d="M 7.236328125 0 L 0 0 0 7.236328125" fill="none" stroke="rgba(207, 207, 207, 0.3)" stroke-width="1" data-v-22c0fba1></path></pattern><pattern id="grid" width="36.181640625" height="36.181640625" patternUnits="userSpaceOnUse" data-v-22c0fba1><rect width="36.181640625" height="36.181640625" fill="url(#smallGrid)" data-v-22c0fba1></rect><path d="M 36.181640625 0 L 0 0 0 36.181640625" fill="none" stroke="rgba(186, 186, 186, 0.5)" stroke-width="1" data-v-22c0fba1></path></pattern></defs><rect width="100%" height="100%" fill="url(#grid)" data-v-22c0fba1></rect>',2),wn=[Sn];function Dn(e,n){return h(),E("svg",bn,wn)}var En=T(xn,[["render",Dn],["__scopeId","data-v-22c0fba1"]]);const kn={class:"mark-line"},$n=U({setup(e){const n=z(),t=w([]),s=Y(["xt","xc","xb","yl","yc","yr"]),d=w(3),a=Y({xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}),p=l=>{t.value.push(l)},i=()=>{Object.keys(a).forEach(l=>{a[l]=!1})};Pe("move",l=>{c(l.isDownward,l.isRightward)}),Pe("unmove",()=>{i()});const c=(l,v)=>{const f=n.componentData,C=Ue(n.curComponent.style),k=(C.width||0)/2,A=(C.height||0)/2;i(),f.forEach(I=>{if(I==n.curComponent)return;const Z=Ue(I.style),{top:O,left:K,bottom:ee,right:te}=Z,ie=Z.width/2,ce=Z.height/2,fe={top:[{isNearly:u(C.top,O),lineNode:t.value[0],line:"xt",dragShift:O,lineShift:O},{isNearly:u(C.bottom,O),lineNode:t.value[0],line:"xt",dragShift:O-(C.height||0),lineShift:O},{isNearly:u((C.top||0)+A,O+ce),lineNode:t.value[1],line:"xc",dragShift:O+ce-A,lineShift:O+ce},{isNearly:u(C.top,ee),lineNode:t.value[2],line:"xb",dragShift:ee,lineShift:ee},{isNearly:u(C.bottom,ee),lineNode:t.value[2],line:"xb",dragShift:ee-(C.height||0),lineShift:ee}],left:[{isNearly:u(C.left,K),lineNode:t.value[3],line:"yl",dragShift:K,lineShift:K},{isNearly:u(C.right,K),lineNode:t.value[3],line:"yl",dragShift:K-(C.width||0),lineShift:K},{isNearly:u((C.left||0)+k,K+ie),lineNode:t.value[4],line:"yc",dragShift:K+ie-k,lineShift:K+ie},{isNearly:u(C.left,te),lineNode:t.value[5],line:"yr",dragShift:te,lineShift:te},{isNearly:u(C.right,te),lineNode:t.value[5],line:"yr",dragShift:te-(C.width||0),lineShift:te}]},ne=[],{rotate:M}=n.curComponent.style;Object.keys(fe).forEach(b=>{fe[b].forEach(y=>{!y.isNearly||(n.setShapeSingleStyle({key:b,value:M!=0?r(b,y,C):y.dragShift}),y.lineNode.style[b]=`${y.lineShift}px`,ne.push(y.line))})}),ne.length&&m(ne,l,v)})},u=(l,v)=>Math.abs(l-v)<=d.value,r=(l,v,f)=>{const{width:C,height:k}=n.curComponent.style;return l=="top"?Math.round(v.dragShift-(k-f.height)/2):Math.round(v.dragShift-(C-f.width)/2)},m=(l,v,f)=>{f?l.includes("yr")?a.yr=!0:l.includes("yc")?a.yc=!0:l.includes("yl")&&(a.yl=!0):l.includes("yl")?a.yl=!0:l.includes("yc")?a.yc=!0:l.includes("yr")&&(a.yr=!0),v?l.includes("xb")?a.xb=!0:l.includes("xc")?a.xc=!0:l.includes("xt")&&(a.xt=!0):l.includes("xt")?a.xt=!0:l.includes("xc")?a.xc=!0:l.includes("xb")&&(a.xb=!0)};return(l,v)=>(h(),E("div",kn,[(h(!0),E(R,null,W(o(s),f=>le((h(),E("div",{key:f,class:me(["line",f.includes("x")?"xline":"yline"]),ref:p},null,2)),[[se,o(a)[f]||!1]])),128))]))}});var Fn=T($n,[["__scopeId","data-v-064d1a04"]]);const Ln={lt:Mn,t:Bn,rt:In,r:An,rb:jn,b:Rn,lb:Vn,l:Pn};function Mn(e,n,t,s,d){const{symmetricPoint:a}=d;let p=we(n,a),i=P(n,p,-e.rotate),c=P(a,p,-e.rotate),u=c.x-i.x,r=c.y-i.y;if(s){u/r>t?i.x+=Math.abs(u-r*t):i.y+=Math.abs(r-u/t);const m=P(i,p,e.rotate);p=we(m,a),i=P(m,p,-e.rotate),c=P(a,p,-e.rotate),u=c.x-i.x,r=c.y-i.y}if(u>0&&r>0){const m={width:Math.round(u),height:Math.round(r),left:Math.round(i.x),top:Math.round(i.y)};Object.assign(e,m)}}function In(e,n,t,s,d){const{symmetricPoint:a}=d;let p=we(n,a),i=P(n,p,-e.rotate),c=P(a,p,-e.rotate),u=i.x-c.x,r=c.y-i.y;if(s){u/r>t?i.x-=Math.abs(u-r*t):i.y+=Math.abs(r-u/t);const m=P(i,p,e.rotate);p=we(m,a),i=P(m,p,-e.rotate),c=P(a,p,-e.rotate),u=i.x-c.x,r=c.y-i.y}if(u>0&&r>0){const m={width:Math.round(u),height:Math.round(r),left:Math.round(c.x),top:Math.round(i.y)};Object.assign(e,m)}}function jn(e,n,t,s,d){const{symmetricPoint:a}=d;let p=we(n,a),i=P(a,p,-e.rotate),c=P(n,p,-e.rotate),u=c.x-i.x,r=c.y-i.y;if(s){u/r>t?c.x-=Math.abs(u-r*t):c.y-=Math.abs(r-u/t);const m=P(c,p,e.rotate);p=we(m,a),i=P(a,p,-e.rotate),c=P(m,p,-e.rotate),u=c.x-i.x,r=c.y-i.y}u>0&&r>0&&(e.width=Math.round(u),e.height=Math.round(r),e.left=Math.round(i.x),e.top=Math.round(i.y))}function Vn(e,n,t,s,d){const{symmetricPoint:a}=d;let p=we(n,a),i=P(a,p,-e.rotate),c=P(n,p,-e.rotate),u=i.x-c.x,r=c.y-i.y;if(s){u/r>t?c.x+=Math.abs(u-r*t):c.y-=Math.abs(r-u/t);const m=P(c,p,e.rotate);p=we(m,a),i=P(a,p,-e.rotate),c=P(m,p,-e.rotate),u=i.x-c.x,r=c.y-i.y}if(u>0&&r>0){const m={width:Math.round(u),height:Math.round(r),left:Math.round(c.x),top:Math.round(i.y)};Object.assign(e,m)}}function Bn(e,n,t,s,d){const{symmetricPoint:a,curPoint:p}=d,i=P(n,p,-e.rotate),c=P({x:p.x,y:i.y},p,e.rotate),u=Math.sqrt(Ce(c.x-a.x,2)+Ce(c.y-a.y,2));if(u>0){const r={x:c.x-(c.x-a.x)/2,y:c.y+(a.y-c.y)/2};let m=e.width;s&&(m=u*t);const l={width:m,height:Math.round(u),left:Math.round(r.x-e.width/2),top:Math.round(r.y-u/2)};Object.assign(e,l)}}function An(e,n,t,s,d){const{symmetricPoint:a,curPoint:p}=d,i=P(n,p,-e.rotate),c=P({x:i.x,y:p.y},p,e.rotate),u=Math.sqrt(Ce(c.x-a.x,2)+Ce(c.y-a.y,2));if(u>0){const r={x:c.x-(c.x-a.x)/2,y:c.y+(a.y-c.y)/2};let m=e.height;s&&(m=u/t);const l={width:Math.round(u),height:m,left:Math.round(r.x-u/2),top:Math.round(r.y-e.height/2)};Object.assign(e,l)}}function Rn(e,n,t,s,d){const{symmetricPoint:a,curPoint:p}=d,i=P(n,p,-e.rotate),c=P({x:p.x,y:i.y},p,e.rotate),u=Math.sqrt(Ce(c.x-a.x,2)+Ce(c.y-a.y,2));if(u>0){const r={x:c.x-(c.x-a.x)/2,y:c.y+(a.y-c.y)/2};let m=e.width;s&&(m=u*t);const l={width:m,height:Math.round(u),left:Math.round(r.x-e.width/2),top:Math.round(r.y-u/2)};Object.assign(e,l)}}function Pn(e,n,t,s,d){const{symmetricPoint:a,curPoint:p}=d,i=P(n,p,-e.rotate),c=P({x:i.x,y:p.y},p,e.rotate),u=Math.sqrt(Ce(c.x-a.x,2)+Ce(c.y-a.y,2));if(u>0){const r={x:c.x-(c.x-a.x)/2,y:c.y+(a.y-c.y)/2};let m=e.height;s&&(m=u/t);const l={width:Math.round(u),height:m,left:Math.round(r.x-u/2),top:Math.round(r.y-e.height/2)};Object.assign(e,l)}}function Un(e,n,t,s,d,a){Ln[e](n,t,s,d,a)}const Nn=ze({id:"compose",state:()=>({style:{top:0,left:0,width:0,height:0},components:[]}),getters:{canCompose(){return this.components.length===0},canDecompose(){const e=z();return!(e.curComponent&&!e.curComponent.isLock&&e.curComponent.component==="Group")}},actions:{isActived(e){return this.components.findIndex(n=>n.id===e.id)!==-1},setAreaData(e,n){this.style=e||{},this.components=n||[]},appendComponent(e){this.components.findIndex(n=>n.id===e.id)===-1&&this.components.push(e)},compose(){const e=[],n=z();if(!n.editor)return;this.style=Ot(this.style,this.components),this.components.forEach(d=>{e.push(d)});const t={component:"Group",style:pe({rotate:0},this.style),subComponents:e};Wt(t),n.addComponent({component:t}),this.batchDeleteComponent(this.components);const s=n.componentData.length-1;n.setCurComponent(n.componentData[s],s),Ne.emit("hideArea"),this.components=[]},batchDeleteComponent(e){const n=z();e.forEach(t=>{for(let s=0,d=n.componentData.length;s<d;s++)if(t.id==n.componentData[s].id){n.componentData.splice(s,1);break}})},decompose(){var d,a;const e=z();if(!e.editor)return;const n=pe({},(d=e.curComponent)==null?void 0:d.style),t=((a=e.curComponent)==null?void 0:a.subComponents)||[],s=e.editor.getBoundingClientRect();t.length>0&&(e.deleteComponent(e.curComponent.id),t.forEach(p=>{Ht(p,s,n),e.addComponent({component:p})}))}}}),ot=()=>Nn(Ae);const zn=["onClick"],Tn={class:"iconfont icon-jiesuo"},On=["onMousedown"],Wn=U({props:{active:{default:!1},element:null,defaultStyle:null,index:null},setup(e){const n=e;ct(b=>({"22824f99":f.value,"216b5136":C.value,"224f3f84":k.value}));const t=z(),s=Ve(),d=ot(),a=w(0),p=w(0),i=N(()=>t.isShowEm),c=w(null),{element:u}=pe({},At(n)),r=Y(["lt","t","rt","r","rb","b","lb","l"]),m=Y({lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315}),l=Y([{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}]),v=w({}),f=w("0px"),C=w("#fff0"),k=w("none"),A=w(!1),I=w("");Rt((b,y,x)=>{if(console.log(b),x==="render function"){if(t.isEditMode){if(y){const{id:S,label:F}=y.element||{};I.value=`\u7EC4\u4EF6[${F}][${S}]\u6E32\u67D3\u5F02\u5E38`}else I.value="\u7EC4\u4EF6\u6E32\u67D3\u5F02\u5E38";f.value="5px",C.value="red",k.value="dashed",A.value=!0}return!1}else return!0});const Z=N(()=>n.active&&!n.element.isLock||d.isActived(n.element)),O=N(()=>t.layerComponent?t.layerComponent.id===n.element.id:!1),K=()=>{d.appendComponent(n.element)},ee=b=>{const{width:y,height:x}=n.defaultStyle,S=/t/.test(b),F=/b/.test(b),L=/l/.test(b),B=/r/.test(b);let H=0,ae=0;return b.length===2?(H=L?0:y,ae=S?0:x):((S||F)&&(H=y/2,ae=S?0:x),(L||B)&&(H=L?0:y,ae=Math.floor(x/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${H}px`,top:`${ae}px`,cursor:v.value[b]}},te=b=>{if(t.setClickComponentStatus(!0),b.preventDefault(),b.stopPropagation(),t.setCurComponent(n.element,n.index),n.element.isLock)return;v.value=M();const y=pe({},n.defaultStyle),x=b.clientY,S=b.clientX,F=Number(y.top),L=Number(y.left);let B=!1;const H=re=>{B=!0;const de=re.clientX,ve=re.clientY;y.top=ve-x+F,y.left=de-S+L,t.setShapeStyle(y),Pt(()=>{Ne.emit("move",{isDownward:ve-x>0,isRightward:de-S>0})})},ae=()=>{B&&s.recordSnapshot(),Ne.emit("unmove"),document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",ae)};document.addEventListener("mousemove",H),document.addEventListener("mouseup",ae)},ie=b=>{b.stopPropagation(),b.preventDefault()},ce=(b,y)=>{t.setClickComponentStatus(!0),y.stopPropagation(),y.preventDefault();const x=pe({},n.defaultStyle),S=x.width/x.height,F={x:x.left+x.width/2,y:x.top+x.height/2};if(!t.editor)return;const L=t.editor.getBoundingClientRect(),B=y.target.getBoundingClientRect(),H={x:Math.round(B.left-L.left+y.target.offsetWidth/2),y:Math.round(B.top-L.top+y.target.offsetHeight/2)},ae={x:F.x-(H.x-F.x),y:F.y-(H.y-F.y)};let re=!1,de=!0;const ve=fe(),De=$e=>{if(de){de=!1;return}re=!0;const Le={x:$e.clientX-L.left,y:$e.clientY-L.top};Un(b,x,Le,S,ve,{center:F,curPoint:H,symmetricPoint:ae}),t.setShapeStyle(x)},ke=()=>{document.removeEventListener("mousemove",De),document.removeEventListener("mouseup",ke),re&&s.recordSnapshot()};document.addEventListener("mousemove",De),document.addEventListener("mouseup",ke)},fe=()=>{if(n.element.component!="Group")return!1;const b=[0,90,180,360];for(const y of n.element.subComponents)if(!b.includes(Ke(parseInt(y.style.rotate))))return!0;return!1},ne=b=>{if(!c.value)return;t.setClickComponentStatus(!0),b.preventDefault(),b.stopPropagation();const y=pe({},n.defaultStyle),x=b.clientY,S=b.clientX,F=y.rotate,L=c.value.getBoundingClientRect(),B=L.left+L.width/2,H=L.top+L.height/2,ae=Math.atan2(x-H,S-B)/(Math.PI/180);let re=!1;const de=De=>{re=!0;const ke=De.clientX,$e=De.clientY,Le=Math.atan2($e-H,ke-B)/(Math.PI/180);y.rotate=F+Le-ae,t.setShapeStyle(y)},ve=()=>{re&&s.recordSnapshot(),document.removeEventListener("mousemove",de),document.removeEventListener("mouseup",ve),v.value=M()};document.addEventListener("mousemove",de),document.addEventListener("mouseup",ve)},M=()=>{if(!t.curComponent)return{};const b=Ke(t.curComponent.style.rotate),y={};let x=-1;return r.forEach(S=>{const F=Ke(m[S]+b),L=l.length;for(;;){x=(x+1)%L;const B=l[x];if(F<23||F>=338){y[S]="nw-resize";return}if(B.start<=F&&F<B.end){y[S]=B.cursor+"-resize";return}}}),y};return Ee(()=>{v.value=M()}),ye(()=>n.defaultStyle,b=>{a.value=b.left,p.value=b.top},{deep:!0,immediate:!0}),(b,y)=>(h(),E("div",{ref:(x,S)=>{S.shape=x,c.value=x},class:me(["shape",{active:o(Z)||e.active,layerActive:o(O)}]),onClick:[he(K,["ctrl","exact"]),he(ie,["exact"])],onMousedown:te},[le(D("span",{class:"error-info"},ue(I.value),513),[[se,A.value]]),le(D("span",{class:"iconfont icon-xuanzhuan",onMousedown:ne},null,544),[[se,o(Z)]]),le(D("span",Tn,null,512),[[se,o(u).isLock]]),le(D("em",null,"("+ue(a.value)+","+ue(p.value)+")",513),[[se,o(i)]]),(h(!0),E(R,null,W(o(Z)?o(r):[],x=>(h(),E("div",{class:"shape-point",onMousedown:S=>ce(x,S),key:x,style:oe(ee(x))},null,44,On))),128)),rt(b.$slots,"default",{},void 0,!0)],42,zn))}});var Hn=T(Wn,[["__scopeId","data-v-9a81f088"]]);const Xn=["onContextmenu"],Yn=U({setup(e){const n=z(),t=ot();let s=w(0),d=w(0),a=w(!1);const p=w(null),i=()=>{Z.value=!1,A.value=0,I.value=0,t.setAreaData({left:0,top:0,width:0,height:0},[])};Pe("hideArea",i),Ee(()=>{console.log("\u8FDB\u5165\u7F16\u8F91\u6A21\u5F0F"),n.setEditMode(mt.EDIT),document.addEventListener("keydown",ne)}),Be(()=>{console.log("\u8FDB\u5165\u9884\u89C8\u6A21\u5F0F"),n.setEditMode(mt.PREVIEW),document.removeEventListener("keydown",ne)});const c=N(()=>n.componentData),u=N(()=>n.canvasStyleData),r=N(()=>n.curComponent),m=N(()=>Xt(u.value)),l=Te("canvasData",JSON.stringify(c.value),window==null?void 0:window.localStorage),v=Te("canvasStyle",JSON.stringify(u.value),window==null?void 0:window.localStorage),f=w(0),C=w(0),k=Y({x:0,y:0}),A=w(0),I=w(0),Z=w(!1),O=w(null),K=M=>{s.value=M.clientY,d.value=M.clientX+20,a.value=!0};Oe(p,()=>a.value=!1);const ee=M=>{var L;M.preventDefault(),i();const b=(L=O.value)==null?void 0:L.getBoundingClientRect();f.value=b.x,C.value=b.y;const y=M.clientX,x=M.clientY;k.x=y-f.value,k.y=x-C.value,Z.value=!0;const S=B=>{A.value=Math.abs(B.clientX-y),I.value=Math.abs(B.clientY-x),B.clientX<y&&(k.x=B.clientX-f.value),B.clientY<x&&(k.y=B.clientY-C.value)},F=B=>{if(document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",F),B.clientX==y&&B.clientY==x){i();return}te()};document.addEventListener("mousemove",S),document.addEventListener("mouseup",F)},te=()=>{const M=ie();if(M.length<=1){i();return}let b=1/0,y=1/0,x=-1/0,S=-1/0;M.forEach(F=>{let L={};F.component=="Group"?F.subComponents.forEach(B=>{const H=document.querySelector(`#component${B.id}`).getBoundingClientRect();L.left=H.left-f.value,L.top=H.top-C.value,L.right=H.right-f.value,L.bottom=H.bottom-C.value,L.left<y&&(y=L.left),L.top<b&&(b=L.top),L.right>x&&(x=L.right),L.bottom>S&&(S=L.bottom)}):L=Ue(F.style),L.left<y&&(y=L.left),L.top<b&&(b=L.top),L.right>x&&(x=L.right),L.bottom>S&&(S=L.bottom)}),k.x=Math.round(y),k.y=Math.round(b),A.value=Math.round(x-y),I.value=Math.round(S-b),t.setAreaData({left:y,top:b,width:A.value,height:I.value},M)},ie=()=>{const M=[],{x:b,y}=k;return n.componentData.forEach(x=>{if(x.isLock)return;const S=Ue(x.style);b<=S.left&&y<=S.top&&S.left+S.width<=b+A.value&&S.top+S.height<=y+I.value&&M.push(x)}),M},ce=M=>{const b={};return["width","height","top","left","rotate"].forEach(x=>{x!="rotate"?b[x]=M[x]+"px":b.transform="rotate("+M[x]+"deg)"}),b},fe=M=>Yt(M,["top","left","width","height","rotate"]),ne=M=>{if(r.value&&M.ctrlKey)switch(M.key){case"ArrowLeft":M.preventDefault(),n.curComponent.style.left=r.value.style.left-1;break;case"ArrowUp":M.preventDefault(),n.curComponent.style.top=r.value.style.top-1;break;case"ArrowRight":M.preventDefault(),n.curComponent.style.left=r.value.style.left+1;break;case"ArrowDown":M.preventDefault(),n.curComponent.style.top=r.value.style.top+1;break;default:M.stopPropagation()}else M.stopPropagation()};return ye(()=>n.componentData,(M,b)=>{M&&(l.value=JSON.stringify(M))},{deep:!0}),ye(()=>n.canvasStyleData,(M,b)=>{M&&(v.value=JSON.stringify(M))},{deep:!0}),(M,b)=>(h(),E("div",{class:"editor edit",ref:(y,x)=>{x.editor=y,O.value=y},id:"editor",style:oe(o(m)),onContextmenu:he(K,["prevent"]),onMousedown:ee},[g(En),(h(!0),E(R,null,W(o(c),(y,x)=>(h(),$(Hn,{id:"shape"+y.id,defaultStyle:y.style,style:oe(ce(y.style)),key:y.id,active:y.id===(o(r)||{}).id,element:y,index:x,class:me({lock:y.isLock})},{default:_(()=>[(h(),$(Ut(y.component),{class:"component",style:oe(fe(y.style)),propValue:y.propValue,element:y,id:"component"+y.id,subComponents:y.subComponents},null,8,["style","propValue","element","id","subComponents"]))]),_:2},1032,["id","defaultStyle","style","active","element","index","class"]))),128)),g(gn,{curComponent:o(r),menuTop:o(s),menuLeft:o(d),display:o(a),"onUpdate:display":b[0]||(b[0]=y=>dt(a)?a.value=y:a=y),ref:(y,x)=>{x.contextMenu=y,p.value=y}},null,8,["curComponent","menuTop","menuLeft","display"]),g(Fn),le(g(Cn,{start:o(k),width:A.value,height:I.value},null,8,["start","width","height"]),[[se,Z.value]])],44,Xn))}});var Gn=T(Yn,[["__scopeId","data-v-a0d3efba"]]);const qn={class:"total"},Jn={class:"icon_lists"},Kn=["onClick"],Qn=U({props:{visible:null},emits:["update:visible"],setup(e,{emit:n}){const t=Y(["icon-zu","icon-zhuxingtu","icon-yibiaopan","icon-tubiao-bingtu","icon-tubiao-qiapian","icon-tubiao-zhexiantu","icon-anniuzu","icon-daohang","icon-liebiao","icon-caimeiji","icon-qita","icon-dingzhi","icon-jichu","icon-chartt","icon-zhuangshizhuangxiu","icon-wenduji","icon-tiaoxingjindutu","icon-biankuang","icon-jindutu","icon-jinggao1","icon-yujingdeng","icon-zidongxitongjinggaodeng1","icon-yujing1","icon-yujing3","icon-jinggaodeng","icon-baojing1","icon-hong","icon-yujingdeng1","icon-a-baojingjinggaoyujingjinggaodeng","icon-light","icon-gaojingdeng9","icon-jinggaodeng1","icon-yujing5","icon-shanchu","icon-shanchu1","icon-shouye","icon-chakan","icon-bianji","icon-fuzhi","icon-shouye-moren","icon-jiesuo","icon-xuanzhuan","icon-kaiguan","icon-clock","icon-fankuixinxi","icon-leijianzhuxiulix","icon-weibiaoti-","icon-sds_di37leijianzhuxiuli","icon-liandongkongzhi","icon-unlock-full","icon-ascend","icon-falling","icon-buttonoff","icon-buttonon","icon-jiantoushang","icon-jiantouyou","icon-jiantouxia","icon-24gl-next","icon-24gl-pauseCircle","icon-24gl-previous","icon-24gl-stopCircle","icon-anniu_kaiqi","icon-anniu_guanbi","icon-jiantoushangzuo-copy","icon-xiangzuo2-copy","icon-guanbibofang","icon-xiangshang3","icon-xiangxia5","icon-xiangyou2","icon-youbofang","icon-zuobofang","icon-bofang2","icon-bofang5","icon-xiangzuojiaohuan","icon-xiangyoujiaohuan","icon-bofang6","icon-24gl-playCircle","icon-xiangshang7","icon-bofang26","icon-play1","icon-bofang-kuaitui","icon-bofang09","icon-bofang-kuaijin","icon-xiangxia7"]),s=w(null);Oe(s,()=>{n("update:visible",!1)});const d=a=>{Je(a),Me(`\u590D\u5236\u56FE\u6807: ${a}`)};return(a,p)=>(h(),E("div",null,[(h(),$(pt,{to:"body"},[le(D("div",{class:"tab-container",ref:(i,c)=>{c.iconDiv=i,s.value=i}},[D("div",qn,"\u56FE\u6807\u6570\u91CF\uFF1A"+ue(o(t).length),1),D("ul",Jn,[(h(!0),E(R,null,W(o(t),i=>(h(),E("li",{key:i,class:"dib",onClick:c=>d(i)},[D("span",{class:me(`icon iconfont ${i}`)},null,2)],8,Kn))),128))])],512),[[se,e.visible]])]))]))}});var Zn=T(Qn,[["__scopeId","data-v-113b4986"]]);const eo=()=>xe(void 0,null,function*(){return an.get({url:"/files"})});const to=["src","onClick"],no=X("\u4E0A\u4F20"),oo=U({props:{visible:null},emits:["update:visible"],setup(e,{emit:n}){const t=Gt(),s=()=>xe(this,null,function*(){Me("\u4E0A\u4F20\u6210\u529F"),yield r()}),d=()=>xe(this,null,function*(){qt("\u4E0A\u4F20\u5931\u8D25")}),a=w("http://152.136.230.20:13000"),p=N(()=>{const m=t.userToken;if(m)return{authorization:m}}),i=w(null);let c=w([]);Oe(i,()=>{n("update:visible",!1)});const u=m=>{Je(`${a.value}${m}`),Me(`\u590D\u5236\u56FE\u7247\u5730\u5740: ${m}`)};Ee(()=>xe(this,null,function*(){yield r()}));const r=()=>xe(this,null,function*(){c.value=yield eo()});return(m,l)=>(h(),E("div",null,[(h(),$(pt,{to:"body"},[le(g(o(Ie),{class:"container",ref:(v,f)=>{f.imgDiv=v,i.value=v}},{default:_(()=>[(h(!0),E(R,null,W(o(c),v=>(h(),E("div",{key:v.md5},[g(o(yt),{class:"card"},{default:_(()=>[D("img",{src:`${a.value}${v.url}`,class:"image",onClick:f=>u(v.url)},null,8,to)]),_:2},1024)]))),128)),D("div",null,[g(o(yt),{class:"card upload-card"},{default:_(()=>[g(o(gt),{class:"upload",action:`${a.value}/upload`,"list-type":"picture-card","thumbnail-mode":!1,"show-file-list":!1,"on-success":s,"on-error":d,headers:o(p)},{default:_(()=>[g(o(ln),null,{default:_(()=>[no]),_:1})]),_:1},8,["action","headers"])]),_:1})])]),_:1},512),[[se,e.visible]])]))]))}});var ao=T(oo,[["__scopeId","data-v-3ddf1b64"]]);const lo={class:"toolbar"},so={class:"title"},uo={class:"toolbar-item"},io=X("\u64A4\u6D88"),co=X("\u9884\u89C8"),ro=X("\u4FDD\u5B58"),po=X("\u6062\u590D\u8349\u7A3F"),mo=X("\u6E05\u7A7A\u753B\u5E03"),ho=X("\u5BFC\u51FA"),fo=X("\u5BFC\u5165"),vo=X("\u5168\u5C4F\u7F16\u8F91"),yo=X("\u7EC4\u5408"),go=X("\u62C6\u5206"),_o=X("\u663E\u793A\u5750\u6807"),Co=X("\u56FE\u6807"),xo=X("\u56FE\u7247"),bo=X("\u6587\u4EF6\u9009\u62E9"),So={class:"dialog-footer"},wo=X("\u53D6\u6D88"),Do=X("\u65B0\u589E\u9875\u9762"),Eo=X("\u66F4\u65B0\u9875\u9762"),ko=U({emits:["recovery"],setup(e,{emit:n}){const t=z(),s=Ve(),d=ot(),a=en(),p=vt(),i=N(()=>t.componentData),c=N(()=>t.canvasStyleData),u=N(()=>p.path==="/create");let r="";const m=w(!1),l=w(!1),v=w(!1),f=Y({name:"",thumbnail:""}),C=Y({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u9875\u9762\u540D\u79F0",trigger:"blur"}]});Ee(()=>{setTimeout(()=>{f.name=t.name,f.thumbnail=t.thumbnail},500)});const k=()=>{s.undo()},A=()=>{const{href:x}=a.resolve("/preview");window.open(x,"_blank")},I=()=>{m.value=!0},Z=(x,S)=>{const F=new FileReader;F.readAsDataURL(x.raw),F.onload=()=>{f.thumbnail=F.result}},O=()=>{s.recordSnapshot(),t.clearCanvas()},K=()=>{s.recordSnapshot(),d.compose()},ee=()=>{s.recordSnapshot(),d.decompose()},te=()=>{n("recovery")},ie=()=>{t.toggleShowEm()},ce=()=>{l.value=!l.value},fe=()=>{const x=document.querySelector(".center.scrollbar");document.fullscreenEnabled&&x&&x.requestFullscreen()},ne=x=>xe(this,null,function*(){const{name:S,thumbnail:F}=f;if(!S){Qe("\u8BF7\u8F93\u5165\u9875\u9762\u540D\u79F0");return}const L={name:S,thumbnail:F,canvasData:i.value,canvasStyle:c.value};if(t.setName(S),t.setThumbnail(F),x==="update")try{yield tn(r,L),Me("\u4FEE\u6539\u6210\u529F")}catch(B){Qe("\u4FDD\u5B58\u5931\u8D25\uFF0C\u8BF7\u5BFC\u51FA\u5230\u672C\u5730\uFF0C\u5E76\u91CD\u65B0\u8FDB\u5165\u6B64\u9875\u9762")}finally{m.value=!1}else try{const B=yield nn(L);Me("\u4FDD\u5B58\u6210\u529F"),a.push({name:"Editor",params:{index:B.id}})}catch(B){Qe(`\u4FDD\u5B58\u5931\u8D25\uFF0C\u5931\u8D25\u4FE1\u606F:${(B==null?void 0:B.message)||B}`)}finally{m.value=!1}}),M=()=>{const x=`${t.name}`||"layout";Jt(`${x}.json`,JSON.stringify({canvasData:i.value,canvasStyle:c.value}))},b=()=>{Kt()},y=ye(()=>p.params.index,(x,S)=>{r=x},{immediate:!0});return Be(()=>{y()}),(x,S)=>(h(),E(R,null,[D("div",lo,[D("div",so,ue(o(t).name),1),D("div",uo,[g(o(q),{class:"realbutton",onClick:k},{default:_(()=>[io]),_:1}),g(o(q),{class:"realbutton",onClick:A},{default:_(()=>[co]),_:1}),g(o(q),{class:"realbutton",onClick:I},{default:_(()=>[ro]),_:1}),g(o(q),{class:"realbutton",onClick:te},{default:_(()=>[po]),_:1}),g(o(q),{class:"realbutton",onClick:O},{default:_(()=>[mo]),_:1}),g(o(q),{class:"realbutton",onClick:M},{default:_(()=>[ho]),_:1}),g(o(q),{class:"realbutton",onClick:b},{default:_(()=>[fo]),_:1}),g(o(q),{class:"realbutton",onClick:fe},{default:_(()=>[vo]),_:1}),g(o(q),{class:"realbutton",onClick:K,disabled:o(d).canCompose},{default:_(()=>[yo]),_:1},8,["disabled"]),g(o(q),{class:"realbutton",onClick:ee,disabled:o(d).canDecompose},{default:_(()=>[go]),_:1},8,["disabled"]),g(o(q),{class:"realbutton",onClick:ie},{default:_(()=>[_o]),_:1}),g(o(q),{class:"realbutton",onClick:ce},{default:_(()=>[Co]),_:1}),g(o(q),{class:"realbutton",onClick:S[0]||(S[0]=()=>v.value=!0)},{default:_(()=>[xo]),_:1})])]),g(o(sn),{modelValue:m.value,"onUpdate:modelValue":S[6]||(S[6]=F=>m.value=F),title:"\u4FDD\u5B58\u5F53\u524D\u5E03\u5C40",width:"30%",center:""},{footer:_(()=>[D("span",So,[g(o(q),{onClick:S[3]||(S[3]=F=>m.value=!1)},{default:_(()=>[wo]),_:1}),o(u)?(h(),$(o(q),{key:0,type:"primary",onClick:S[4]||(S[4]=F=>ne("new"))},{default:_(()=>[Do]),_:1})):(h(),$(o(q),{key:1,type:"primary",onClick:S[5]||(S[5]=F=>ne("update"))},{default:_(()=>[Eo]),_:1}))])]),default:_(()=>[g(o(We),{model:o(f),rules:o(C),onSubmit:S[2]||(S[2]=he(()=>{},["prevent"]))},{default:_(()=>[g(o(be),{label:"\u9875\u9762\u540D\u79F0",prop:"name"},{default:_(()=>[g(o(Se),{modelValue:o(f).name,"onUpdate:modelValue":S[1]||(S[1]=F=>o(f).name=F),placeholder:"\u8BF7\u8F93\u5165\u9875\u9762\u540D\u79F0"},null,8,["modelValue"])]),_:1}),g(o(be),{label:"\u4E0A\u4F20\u7F29\u7565\u56FE"},{default:_(()=>[g(o(gt),{"on-change":Z,action:"","list-type":"picture",limit:1,"auto-upload":!1},{default:_(()=>[g(o(q),{size:"small",type:"primary"},{default:_(()=>[bo]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),g(Zn,{visible:l.value,"onUpdate:visible":S[7]||(S[7]=F=>l.value=F)},null,8,["visible"]),g(ao,{visible:v.value,"onUpdate:visible":S[8]||(S[8]=F=>v.value=F)},null,8,["visible"])],64))}});var $o=T(ko,[["__scopeId","data-v-e96aa726"]]);const Fo=["onMousedown"],Lo=["onMousedown"],Mo=["title","onMousedown"],Io={class:"vue-ruler-content-mask"},jo=U({props:{isHotKey:{default:!0},isScaleRevise:{default:!1},contentLayout:{default:{top:0,left:0}},parent:{default:void 0},visible:{default:!0},stepLength:{default:50},borderStyle:{default:{color:"#red",type:"dashed",width:1}},canvas:{default:!0}},emits:["update:visible"],setup(e,{emit:n}){const t=e,s=Y([]),d=w(17),a=w(18),p=w(0),i=w(0);let c=Y([]),u=Y([]);const r=w(0),m=w(0),l=w(!1),v=w(""),f=w(-999),C=w(-999),k=w(0),A=w(0),I=w(""),Z=Y({r:82}),O=w(!0),K=w(null),ee=w(null),te=w(null),ie=z(),ce=N(()=>({width:p.value+"px",height:i.value+"px"})),fe=N(()=>({left:t.contentLayout.left+"px",top:t.contentLayout.top+"px",padding:a.value+"px 0px 0px "+a.value+"px"})),ne=N(()=>{let V=0,J=0;return s.map(j=>{const G=j.type==="h";return{id:`${j.type}_${G?V++:J++}`,type:j.type,title:j.site.toFixed(2)+"px",[G?"top":"left"]:j.site/(t.stepLength/50)+d.value}})});ye(()=>t.visible,V=>{O.value=V},{immediate:!0}),Ee(()=>{document.addEventListener("mousemove",re),document.addEventListener("mouseup",de),document.addEventListener("keyup",st),M(),window.onresize=()=>{b()}}),Be(()=>{document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",de),document.removeEventListener("keyup",st),window.onresize=null});const M=()=>{S(),L()},b=()=>{c=[],u=[],M()},y=({type:V,top:J,left:j})=>{const G={borderWidth:t.borderStyle.width+"px",borderStyle:t.borderStyle.type,borderColor:t.borderStyle.color};return pe(V==="h"?{top:J+"px"}:{left:j+"px"},G)},x=({type:V,id:J})=>V==="h"?$e(J):Le(J),S=()=>{if(t.isScaleRevise){const V=K.value,J=V.offsetLeft,j=V.offsetTop;H(c,J),H(u,j)}if(t.parent){const{width:V,height:J}=t.parent.getBoundingClientRect();p.value=V,i.value=J}else t.canvas?(p.value=ie.canvasStyleData.width,i.value=ie.canvasStyleData.height):(p.value=document.documentElement.clientWidth-m.value,i.value=document.documentElement.clientHeight-r.value);k.value=ee.value.clientWidth,A.value=te.value.clientHeight,F()},F=()=>{r.value=te.value.getBoundingClientRect().y,m.value=ee.value.getBoundingClientRect().x},L=()=>{B(c,p.value),B(u,i.value)},B=(V,J)=>{for(let j=0;j<J*t.stepLength/50;j+=t.stepLength)j%t.stepLength==0&&V.push({id:j})},H=(V,J)=>{for(let j=0;j<J;j+=1)j%t.stepLength==0&&j+t.stepLength<=J&&V.push({id:j})},ae=V=>{l.value=!0,v.value=V},re=V=>{switch(F(),v.value){case"h":case"x":l.value&&(C.value=V.pageY-r.value);break;case"v":case"y":l.value&&(f.value=V.pageX-m.value);break}},de=V=>{if(F(),l.value){switch(v.value){case"x":lt({type:"h",site:(V.pageY-r.value-d.value)*(t.stepLength/50)});break;case"y":lt({type:"v",site:(V.pageX-m.value-d.value)*(t.stepLength/50)});break;case"h":ve(s,V.pageY,r.value,A.value,"h");break;case"v":ve(s,V.pageX,m.value,k.value,"v");break}C.value=f.value=-50,l.value=!1,I.value=""}},ve=(V,J,j,G,Ft)=>{J-j<G?ne.value.forEach((Xe,Ye)=>{Xe.id===I.value&&V.splice(Ye,1)}):ne.value.forEach((Xe,Ye)=>{Xe.id===I.value&&V.splice(Ye,1,{type:Ft,site:(J-j-d.value)*(t.stepLength/50)})})},De=()=>{ae("x")},ke=()=>{ae("y")},$e=V=>{l.value=!0,v.value="h",I.value=V},Le=V=>{l.value=!0,v.value="v",I.value=V},lt=V=>{V.site>d.value&&s.push(V)},st=V=>{t.isHotKey&&V.keyCode===Z.r&&(O.value=!O.value,n("update:visible",O.value),O.value?a.value=18:a.value=0)};return(V,J)=>(h(),E("div",{style:oe(o(ce)),class:"vue-ruler-wrapper",onselectstart:"return false;"},[le(D("section",null,[D("div",{ref:(j,G)=>{G.horizontalRuler=j,te.value=j},class:"vue-ruler-h",onMousedown:he(De,["stop"])},[(h(!0),E(R,null,W(o(c),(j,G)=>(h(),E("span",{key:G,style:oe({left:G*50+2+"px"}),class:"n"},ue(j.id),5))),128))],40,Fo),D("div",{ref:(j,G)=>{G.verticalRuler=j,ee.value=j},class:"vue-ruler-v",onMousedown:he(ke,["stop"])},[(h(!0),E(R,null,W(o(u),(j,G)=>(h(),E("span",{key:G,style:oe({top:G*50+2+"px"}),class:"n"},ue(j.id),5))),128))],40,Lo),D("div",{style:oe({top:C.value+"px"}),class:"vue-ruler-ref-dot-h"},null,4),D("div",{style:oe({left:f.value+"px"}),class:"vue-ruler-ref-dot-v"},null,4),(h(!0),E(R,null,W(o(ne),j=>(h(),E("div",{title:j.title,style:oe(y(j)),key:j.id,class:me(`vue-ruler-ref-line-${j.type}`),onMousedown:G=>x(j)},[D("span",null,ue(j.title),1)],46,Mo))),128))],512),[[se,O.value]]),D("div",{ref:(j,G)=>{G.contentEl=j,K.value=j},class:"vue-ruler-content",style:oe(o(fe))},[rt(V.$slots,"default",{},void 0,!0)],4),le(D("div",Io,null,512),[[se,l.value]])],4))}});var Vo=T(jo,[["__scopeId","data-v-d4b5e728"]]);const Bo={class:"attr-list",style:{height:"calc(100vh - 100px)"}},Ao=X("\u70B9\u51FB\u83B7\u53D6\u5C4F\u5E55\u5927\u5C0F"),Ro=U({setup(e){const n=z(),t=N(()=>n.canvasStyleData),s=[{key:"width",label:"\u5BBD\u5EA6",type:"number"},{key:"height",label:"\u9AD8\u5EA6",type:"number"},{key:"scale",label:"\u6BD4\u4F8B",type:"number"},{key:"alertWs",label:"\u5B9E\u65F6\u62A5\u8B66",type:"text"},{key:"dataWs",label:"\u5B9E\u65F6\u6570\u636E",type:"text"},{key:"image",label:"\u80CC\u666F\u56FE",type:"text"}],d=Y(["top","left","width","height","fontSize","borderWidth"]),a=w(t.value.scale),p=r=>r*a.value/100,i=r=>r/(t.value.scale/100),c=ft(()=>{a.value=~~a.value||1;const r=Fe(n.componentData);r.forEach(m=>{Object.keys(m.style).forEach(l=>{d.includes(l)&&(m.style[l]=Math.ceil(p(i(m.style[l]))))})}),n.setComponentData(r),n.setCanvasStyle(Ge(pe({},t.value),{scale:a.value}))},1e3),u=()=>{n.setCanvasStyle(Ge(pe({},t.value),{width:window.innerWidth,height:window.innerHeight}))};return(r,m)=>(h(),E("div",Bo,[g(o(We),{size:"mini",onSubmit:m[1]||(m[1]=he(()=>{},["prevent"]))},{default:_(()=>[g(o(be),null,{default:_(()=>[g(o(q),{onClick:u},{default:_(()=>[Ao]),_:1})]),_:1}),(h(),E(R,null,W(s,({key:l,label:v,type:f},C)=>g(o(be),{key:C,label:v},{default:_(()=>[l==="scale"?(h(),$(o(Ze),{key:0,modelValue:a.value,"onUpdate:modelValue":m[0]||(m[0]=k=>a.value=k),onInput:o(c)},null,8,["modelValue","onInput"])):f==="number"?(h(),$(o(Ze),{key:1,modelValue:o(t)[l],"onUpdate:modelValue":k=>o(t)[l]=k},null,8,["modelValue","onUpdate:modelValue"])):(h(),$(o(Se),{key:2,modelValue:o(t)[l],"onUpdate:modelValue":k=>o(t)[l]=k},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"])),64))]),_:1})]))}});var Po=T(Ro,[["__scopeId","data-v-438eae4e"]]);const Uo=U({props:{value:{default:""}},emits:["update:value","change"],setup(e,{emit:n}){const t=e,s=Y(["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"]),d=w(t.value),a=p=>{d.value=p||"",n("update:value",d.value),n("change",d.value)};return(p,i)=>(h(),$(o(Se),{clearable:"",modelValue:d.value,"onUpdate:modelValue":i[1]||(i[1]=c=>d.value=c),placeholder:"\u8BF7\u8F93\u5165\u989C\u8272",size:"mini",onChange:a},{append:_(()=>[g(o(un),{modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=c=>d.value=c),predefine:o(s),"show-alpha":"",size:"mini",onChange:a},null,8,["modelValue","predefine"])]),_:1},8,["modelValue"]))}});var at=T(Uo,[["__scopeId","data-v-5225e6eb"]]);const No={class:"attr-list",style:{height:"calc(100vh - 100px)"}},zo=U({setup(e){const n=w(),t=z(),s=Y({}),d=N(()=>t.curComponent&&t.curComponent.component in _e?_e[t.curComponent.component].style:[]),a=N(()=>t.curComponent),p=(u,r)=>{t.curComponent&&(r==="backgroundImage"&&Zt(u)&&(u=`url('/${u}')`),t.curComponent.style[r]=u)};Pe("changeStyle",u=>{const r=u;t.curComponent&&t.curComponent.id===r.id&&c(r.style)});const c=ft(u=>{const r=Qt(u,s);r&&Object.keys(r).forEach(m=>{s[m]=r[m]})},200);return ye(()=>t.curComponent,()=>{ht(s),t.curComponent&&c(t.curComponent.style)},{immediate:!0}),(u,r)=>(h(),E("div",No,[g(o(Ie),null,{default:_(()=>[o(a)?(h(),$(o(We),{key:0,size:"mini",onSubmit:r[1]||(r[1]=he(()=>{},["prevent"]))},{default:_(()=>[(h(!0),E(R,null,W(o(d),({name:m,uid:l,children:v})=>(h(),$(o(et),{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=f=>n.value=f),accordion:"",key:`${o(a).id}${l}`},{default:_(()=>[g(o(He),{title:m,name:l},{default:_(()=>[(h(!0),E(R,null,W(v,({key:f,label:C,type:k,selectOptions:A})=>(h(),$(o(be),{key:`${o(a).id}${f}`,label:C},{default:_(()=>[k==="color"?(h(),$(at,{key:0,value:o(s)[f],"onUpdate:value":I=>o(s)[f]=I,onChange:I=>p(I,f)},null,8,["value","onUpdate:value","onChange"])):k==="select"?(h(),$(o(tt),{key:1,modelValue:o(s)[f],"onUpdate:modelValue":I=>o(s)[f]=I,placeholder:C,onChange:I=>p(I,f)},{default:_(()=>[(h(!0),E(R,null,W(A,I=>(h(),$(o(nt),{key:I.value,label:I.label,value:I.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])):k==="number"?(h(),$(o(Ze),{key:2,modelValue:o(s)[f],"onUpdate:modelValue":I=>o(s)[f]=I,onChange:I=>p(I,f)},null,8,["modelValue","onUpdate:modelValue","onChange"])):(h(),$(o(Se),{key:3,type:k,modelValue:o(s)[f],"onUpdate:modelValue":I=>o(s)[f]=I,onChange:I=>p(I,f)},null,8,["type","modelValue","onUpdate:modelValue","onChange"]))]),_:2},1032,["label"]))),128))]),_:2},1032,["title","name"])]),_:2},1032,["modelValue"]))),128))]),_:1})):qe("",!0)]),_:1})]))}});var To=T(zo,[["__scopeId","data-v-4dc558a2"]]);const Oo=U({props:{curComponent:null},setup(e){return(n,t)=>(h(),$(o(et),null,{default:_(()=>[g(o(He),{title:"\u516C\u5171\u5C5E\u6027",name:"commonAttr"},{default:_(()=>[g(o(be),{label:"\u7C7B\u578B"},{default:_(()=>[g(o(Se),{value:e.curComponent.component,readonly:!0},null,8,["value"])]),_:1}),g(o(be),{label:"ID"},{default:_(()=>[g(o(Se),{value:e.curComponent.id,readonly:!0},null,8,["value"])]),_:1}),g(o(be),{label:"\u540D\u79F0"},{default:_(()=>[g(o(Se),{modelValue:e.curComponent.label,"onUpdate:modelValue":t[0]||(t[0]=s=>e.curComponent.label=s)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))}});const Wo=e=>(Nt("data-v-0f7c42e9"),e=e(),zt(),e),Ho={class:"imgSelect"},Xo={class:"imgSelectInput"},Yo=Wo(()=>D("div",{class:"icon iconfont icon-jiantouxia"},null,-1)),Go=[Yo],qo=["onClick"],Jo=U({props:{value:{default:""},listItem:null},emits:["update:value","change"],setup(e,{emit:n}){const t=e,s=w("hidden");let d=w(t.value);function a(){s.value="show"}function p(){s.value="hidden"}function i(c){d.value=t.listItem[c].label,n("update:value",d.value),n("change",d.value),s.value="hidden"}return(c,u)=>(h(),E("div",Ho,[D("div",Xo,[D("div",{class:"imgInput",onClick:u[0]||(u[0]=r=>p())},[D("div",{class:me(o(d))},null,2)]),D("div",{class:"imgArrow",onClick:u[1]||(u[1]=r=>a())},Go)]),D("div",{class:me(["imgSelectList",s.value])},[(h(!0),E(R,null,W(e.listItem,(r,m)=>(h(),E("div",{class:"imgSelectListItem",key:m,onClick:l=>i(m)},[D("div",{class:me(["itemList",r.label])},null,2)],8,qo))),128))],2)]))}});var Ko=T(Jo,[["__scopeId","data-v-0f7c42e9"]]);const Qo=["onClick"],Zo=X("+"),ea=U({props:{data:null,jsonSchema:null},emits:["update:data","change"],setup(e,{emit:n}){const t=e,s=N(()=>!!(!t.jsonSchema.max||t.jsonSchema.max&&Object.keys(a).length<t.jsonSchema.max)),d=N(()=>Array(Object.keys(a).length)),a=Y({});Ee(()=>{if(t.data)for(let u=0;u<t.data.length;u++)a[`${t.jsonSchema.key}${u}`]=t.data[u];else console.log("[ERROR] props.data is undefined")});const p=()=>{n("update:data",Object.values(a)),n("change",Object.values(a))},i=()=>{const u=Object.keys(a).length;a[`${t.jsonSchema.key}${u}`]=""},c=u=>{delete a[`${t.jsonSchema.key}${u}`],p()};return(u,r)=>(h(),E("div",null,[(h(!0),E(R,null,W(o(d),(m,l)=>(h(),E("div",{key:l,class:"item"},[e.jsonSchema.type==="color"?(h(),$(at,{key:0,value:o(a)[`${e.jsonSchema.key}${l}`],"onUpdate:value":v=>o(a)[`${e.jsonSchema.key}${l}`]=v,onChange:r[0]||(r[0]=v=>p())},null,8,["value","onUpdate:value"])):e.jsonSchema.type==="select"?(h(),$(o(tt),{key:1,modelValue:o(a)[`${e.jsonSchema.key}${l}`],"onUpdate:modelValue":v=>o(a)[`${e.jsonSchema.key}${l}`]=v,onChange:r[1]||(r[1]=v=>p())},{default:_(()=>[(h(!0),E(R,null,W(e.jsonSchema.selectOptions,v=>(h(),$(o(nt),{key:v.value,label:v.label,value:v.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(h(),$(o(Se),{key:2,type:e.jsonSchema.type,modelValue:o(a)[`${e.jsonSchema.key}${l}`],"onUpdate:modelValue":v=>o(a)[`${e.jsonSchema.key}${l}`]=v,onChange:r[2]||(r[2]=v=>p())},null,8,["type","modelValue","onUpdate:modelValue"])),D("span",{class:"iconfont icon-shanchu",onClick:v=>c(l)},null,8,Qo)]))),128)),le(g(o(q),{style:{"border-style":"dashed",width:"100%"},onClick:i},{default:_(()=>[Zo]),_:1},512),[[se,o(s)]])]))}});var ta=T(ea,[["__scopeId","data-v-71d895c3"]]);const Et=U({props:{data:null,children:null,ukey:null},emits:["change"],setup(e,{emit:n}){const t=e,s=Y(t.data),d=(a,p)=>{n("change",a,p)};return ye(()=>t.data,a=>{Object.assign(s,a)},{deep:!0}),(a,p)=>(h(!0),E(R,null,W(e.children,({key:i,label:c,type:u,selectOptions:r,arrayAttr:m})=>(h(),$(o(be),{key:`${e.ukey}${i}`,label:c},{default:_(()=>[u==="color"?(h(),$(at,{key:0,value:o(s)[i],"onUpdate:value":l=>o(s)[i]=l,onChange:l=>d(l,i)},null,8,["value","onUpdate:value","onChange"])):u==="imgSelect"?(h(),$(Ko,{key:1,value:o(s)[i],"onUpdate:value":l=>o(s)[i]=l,listItem:r,onChange:l=>d(l,i)},null,8,["value","onUpdate:value","listItem","onChange"])):u==="array"?(h(),$(ta,{key:2,data:o(s)[i],"onUpdate:data":l=>o(s)[i]=l,jsonSchema:m,onChange:l=>d(l,i)},null,8,["data","onUpdate:data","jsonSchema","onChange"])):u==="select"?(h(),$(o(tt),{key:3,modelValue:o(s)[i],"onUpdate:modelValue":l=>o(s)[i]=l,placeholder:c,onChange:l=>d(l,i)},{default:_(()=>[(h(!0),E(R,null,W(r,l=>(h(),$(o(nt),{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])):u==="radio"?(h(),$(o(cn),{key:4,modelValue:o(s)[i],"onUpdate:modelValue":l=>o(s)[i]=l,placeholder:c,onChange:l=>d(l,i)},{default:_(()=>[(h(!0),E(R,null,W(r,l=>(h(),$(o(rn),{label:l.value,key:l.value},{default:_(()=>[X(ue(l.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])):u==="switch"?(h(),$(o(dn),{key:5,modelValue:o(s)[i],"onUpdate:modelValue":l=>o(s)[i]=l,onChange:l=>d(l,i)},null,8,["modelValue","onUpdate:modelValue","onChange"])):(h(),$(o(Se),{key:6,type:u,modelValue:o(s)[i],"onUpdate:modelValue":l=>o(s)[i]=l,onChange:l=>d(l,i)},null,8,["type","modelValue","onUpdate:modelValue","onChange"]))]),_:2},1032,["label"]))),128))}}),na=U({props:{data:null,children:null,name:null,uid:null,ukey:null},emits:["change"],setup(e,{emit:n}){const s=Y(e.data),d=(a,p)=>{n("change",a,p)};return(a,p)=>(h(),$(o(He),{title:e.name,name:e.uid},{default:_(()=>[g(Et,{children:e.children,data:o(s),ukey:e.ukey,onChange:d},null,8,["children","data","ukey"])]),_:1},8,["title","name"]))}});const oa=X("+"),aa=U({props:{data:null,children:null,name:null,uid:null,max:null,ukey:null},emits:["change"],setup(e,{emit:n}){const t=e,s=w(t.data),d=()=>{n("change",s.value,t.uid)},a=N(()=>s.value.length<t.max),p=()=>{const i=s.value.length,c={};t.children.map(u=>{i>0?c[u.key]=s.value[i-1][u.key]:c[u.key]=""}),s.value.push(c)};return ye(()=>t.data,()=>{s.value=t.data},{deep:!0}),(i,c)=>(h(),E(R,null,[(h(!0),E(R,null,W(s.value,(u,r)=>(h(),$(o(He),{key:`${e.ukey}${r}`,title:e.max>1?`${e.name}${r}`:e.name,name:e.max>1?`${e.uid}${r}`:e.uid},{default:_(()=>[g(Et,{children:e.children,data:u,ukey:e.ukey,onChange:d},null,8,["children","data","ukey"])]),_:2},1032,["title","name"]))),128)),le(g(o(q),{class:"add",onClick:p},{default:_(()=>[oa]),_:1},512),[[se,o(a)]])],64))}});var la=T(aa,[["__scopeId","data-v-cc648e86"]]);const sa={class:"attr-list",style:{height:"calc(100vh - 120px)"}},ua=U({setup(e){const n=w(),t=z(),s=Y({}),d=N(()=>t.curComponent||t.layerComponent),a=N(()=>d.value&&d.value.component in _e?_e[d.value.component].attrs:[]),p=(c,u)=>{t.setCurComponentProp(u,c)},i=()=>{ht(s);const c=t.curComponent||t.layerComponent;if(c&&c.propValue){const u=c.propValue;Object.keys(u).forEach(r=>{s[r]=u[r]})}};return ye(()=>[t.curComponent,t.layerComponent],()=>{i()},{immediate:!0}),(c,u)=>(h(),E("div",sa,[g(o(Ie),null,{default:_(()=>[o(d)?(h(),$(o(We),{key:0,size:"mini",onSubmit:u[1]||(u[1]=he(()=>{},["prevent"]))},{default:_(()=>[g(Oo,{curComponent:o(d)},null,8,["curComponent"]),(h(!0),E(R,null,W(o(a),({name:r,uid:m,children:l,max:v})=>(h(),$(o(et),{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=f=>n.value=f),accordion:"",key:`${o(d).id}${m}`},{default:_(()=>[!v||v<1?(h(),$(na,{key:0,children:l,data:o(s),onChange:p,name:r,uid:m,ukey:o(d).id},null,8,["children","data","name","uid","ukey"])):(h(),$(la,{key:1,children:l,data:o(s)[m],onChange:p,name:r,uid:m,max:v,ukey:o(d).id},null,8,["children","data","name","uid","max","ukey"]))]),_:2},1032,["modelValue"]))),128))]),_:1})):qe("",!0)]),_:1})]))}});var ia=T(ua,[["__scopeId","data-v-ab1e6988"]]);const ca={class:"sidebar"},ra=U({props:{parentSelector:null,expendWidth:null,shrinkWidth:null,expendIcon:null,shrinkIcon:null,position:null},setup(e){const n=e;ct(i=>({"600148d4":d.value}));const t=w("expend"),s=w(n.expendIcon),d=w(n.position),a=()=>{const i=document.querySelector(n.parentSelector);i&&(t.value==="expend"?(i.style.width=`${n.shrinkWidth}px`,s.value=n.shrinkIcon,t.value="shrink"):(i.style.width=`${n.expendWidth}px`,s.value=n.expendIcon,t.value="expend"))},p=()=>n.position==="left"?{left:0}:{right:0};return(i,c)=>(h(),E("div",ca,[D("i",{class:me(`icon iconfont ${s.value}`),onClick:a,style:oe(p())},null,6)]))}});var kt=T(ra,[["__scopeId","data-v-5a874afe"]]);const da=U({setup(e){const n=z(),t=w("style"),s=N(()=>n.curComponent||n.layerComponent);return(d,a)=>(h(),E("div",null,[g(kt,{parentSelector:".right",expendWidth:260,shrinkWidth:12,expendIcon:"icon-jiantouyou",shrinkIcon:"icon-jiantoushangzuo-copy",position:"left"}),g(o(bt),{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=p=>t.value=p),stretch:!0,lazy:!0},{default:_(()=>[g(o(je),{label:"\u6837\u5F0F",name:"style"},{default:_(()=>[o(s)?(h(),$(To,{key:0})):(h(),$(o(xt),{key:1,class:"placeholder"},{default:_(()=>[g(o(_t),null,{default:_(()=>[g(o(Ct),{description:"\u8BF7\u9009\u62E9\u7EC4\u4EF6"})]),_:1})]),_:1}))]),_:1}),g(o(je),{label:"\u5C5E\u6027",name:"attr"},{default:_(()=>[o(s)?(h(),$(ia,{key:0})):(h(),$(o(xt),{key:1,class:"placeholder"},{default:_(()=>[g(o(_t),null,{default:_(()=>[g(o(Ct),{description:"\u8BF7\u9009\u62E9\u7EC4\u4EF6"})]),_:1})]),_:1}))]),_:1}),g(o(je),{label:"\u753B\u5E03",name:"canvas"},{default:_(()=>[g(Po)]),_:1})]),_:1},8,["modelValue"])]))}});var pa=T(da,[["__scopeId","data-v-94f41fe8"]]);const $t={[Q.TEXT]:"icon-bianji",[Q.MACHINEIMG]:"icon-caimeiji",[Q.BASIC]:"icon-jichu",[Q.BORDER]:"icon-biankuang",[Q.DECORATION]:"icon-zhuangshizhuangxiu",[Q.LINE]:"icon-tubiao-zhexiantu",[Q.BAR]:"icon-zhuxingtu",[Q.PERCENTAGE]:"icon-jindutu",[Q.STARTSTOP]:"icon-24gl-stopCircle",[Q.GAUGE]:"icon-yibiaopan",[Q.CUSTOM]:"icon-dingzhi",[Q.SWITCH]:"icon-anniuzu",[Q.Navigation]:"icon-daohang",[Q.Thermometer]:"icon-wenduji",[Q.OTHER]:"icon-qita",[Q.Progress]:"icon-tiaoxingjindutu"};const ma={class:"components"},ha=U({setup(e){const n=N(()=>Object.keys(Q).map(d=>Q[d])),t=N(()=>{const d={};return Object.keys(_e).filter(a=>{if(_e[a].component.show!==!1)return _e[a]}).forEach(a=>{const p=_e[a].component.group;!p||(d[p]||(d[p]=[]),d[p].push(_e[a].component))}),d}),s=d=>{d.dataTransfer.setData("componentName",d.target.dataset.component)};return(d,a)=>(h(),E("div",{onDragstart:s,style:{height:"calc(100vh - 100px)"}},[D("div",ma,[g(o(Ie),null,{default:_(()=>[g(o(St),{"unique-opened":!0},{default:_(()=>[(h(!0),E(R,null,W(o(n),(p,i)=>(h(),$(o(Dt),{index:i.toString(),key:i},{title:_(()=>[D("span",{class:me(`icon iconfont ${o($t)[p]}`)},null,2),D("span",null,ue(p),1)]),default:_(()=>[(h(!0),E(R,null,W(o(t)[p],(c,u)=>(h(),$(o(wt),{key:u,index:`${i}-${u}`,draggable:"true","data-component":c.component},{title:_(()=>[D("span",null,ue(c.label),1)]),_:2},1032,["index","data-component"]))),128))]),_:2},1032,["index"]))),128))]),_:1})]),_:1})])],32))}});var fa=T(ha,[["__scopeId","data-v-6b93943d"]]);const va=U({props:{menuTop:null,menuLeft:null,index:null,display:null},emits:["update:display"],setup(e,{emit:n}){const t=z(),s=Ve(),d=r=>{const m=r.split("-").map(f=>Number(f)),l=m.pop(),v=u(m);v&&(s.recordSnapshot(),v.splice(l,1)),n("update:display",!1)},a=r=>{const m=r.split("-").map(f=>Number(f)),l=m.pop(),v=u(m);v&&(l>0?(s.recordSnapshot(),Re(v,l,l-1)):ge("\u56FE\u5C42\u5DF2\u7ECF\u5230\u5E95\u4E86")),n("update:display",!1)},p=r=>{const m=r.split("-").map(f=>Number(f)),l=m.pop(),v=u(m);if(v){const f=v.length;l<f-1?(s.recordSnapshot(),Re(v,l,l+1)):ge("\u56FE\u5C42\u5DF2\u7ECF\u5230\u9876\u4E86")}n("update:display",!1)},i=r=>{const m=r.split("-").map(f=>Number(f)),l=m.pop(),v=u(m);if(v&&l>0){s.recordSnapshot();const f=v.splice(l,1);v.unshift(f[0])}else ge("\u56FE\u5C42\u5DF2\u7ECF\u5230\u5E95\u4E86");n("update:display",!1)},c=r=>{const m=r.split("-").map(f=>Number(f)),l=m.pop();let v=u(m);if(v){const f=v.length;if(l<f-1){s.recordSnapshot();const C=v.splice(l,1);v.push(C[0])}else ge("\u56FE\u5C42\u5DF2\u7ECF\u5230\u9876\u4E86")}n("update:display",!1)},u=r=>{let m={subComponents:t.componentData,component:"",style:{}};return r.forEach(v=>{m=m.subComponents?m.subComponents[v]:m}),m.subComponents};return(r,m)=>le((h(),E("div",{class:"contextmenu",style:oe({top:e.menuTop+"px",left:e.menuLeft+"px"})},[D("ul",null,[D("li",{onClick:m[0]||(m[0]=l=>d(e.index))},"\u5220\u9664"),D("li",{onClick:m[1]||(m[1]=l=>c(e.index))},"\u7F6E\u9876"),D("li",{onClick:m[2]||(m[2]=l=>i(e.index))},"\u7F6E\u5E95"),D("li",{onClick:m[3]||(m[3]=l=>p(e.index))},"\u4E0A\u4E00\u5C42"),D("li",{onClick:m[4]||(m[4]=l=>a(e.index))},"\u4E0B\u4E00\u5C42")])],4)),[[se,e.display]])}});var ya=T(va,[["__scopeId","data-v-c02aab48"]]);const ga=D("span",{class:"icon iconfont icon-zu"},null,-1),_a=U({props:{components:null,index:null},emits:["select"],setup(e,{emit:n}){const t=e,s=w(null);Oe(s,()=>u());let d=w(!1),a=w(0),p=w(0),i=w("");const c=m=>{let l=t.index;return l?`${l}-${m}`:m.toString()},u=()=>{d.value=!1},r=(m,l)=>{a.value=m.clientY,p.value=m.clientX+20,d.value=!1,m.stopPropagation(),n("select",l),d.value=!0,i.value=l};return(m,l)=>{const v=Tt("LayerItem",!0);return h(),E(R,null,[(h(!0),E(R,null,W(e.components,(f,C)=>(h(),E(R,{key:C},[f.component==="Group"?(h(),$(o(Dt),{key:0,index:c(C),onContextmenu:he(k=>r(k,c(C)),["prevent"])},{title:_(()=>[ga,D("span",null,ue(f.label||"\u5206\u7EC4"),1)]),default:_(()=>[f.subComponents&&f.subComponents.length>0?(h(),$(v,{key:0,components:f.subComponents,index:c(C)},null,8,["components","index"])):qe("",!0)]),_:2},1032,["index","onContextmenu"])):(h(),$(o(wt),{key:1,index:c(C),onContextmenu:he(k=>r(k,c(C)),["prevent"])},{title:_(()=>[D("span",{class:me(`icon iconfont ${o($t)[f.group]}`)},null,2),D("span",null,ue(f.label),1)]),_:2},1032,["index","onContextmenu"]))],64))),128)),g(ya,{display:o(d),"onUpdate:display":l[0]||(l[0]=f=>dt(d)?d.value=f:d=f),menuTop:o(a),menuLeft:o(p),index:o(i),ref:(f,C)=>{C.contextMenu=f,s.value=f}},null,8,["display","menuTop","menuLeft","index"])],64)}}});const Ca={style:{height:"calc(100vh - 100px)"}},xa=U({setup(e){const n=z(),t=N(()=>n.componentData),s=d=>{const a=d.split("-").map(i=>Number(i));let p={subComponents:t.value,component:"",style:{}};a.forEach(i=>{p=p.subComponents?p.subComponents[i]:p}),n.setActiveComponent(p)};return(d,a)=>(h(),E("div",Ca,[g(o(Ie),null,{default:_(()=>[g(o(St),{"unique-opened":!0,"collapse-transition":!1,onSelect:s,onOpen:s},{default:_(()=>[g(_a,{components:o(t),onSelect:s},null,8,["components"])]),_:1})]),_:1})]))}});var ba=T(xa,[["__scopeId","data-v-84b615dc"]]);const Sa=U({setup(e){const n=w("component");return(t,s)=>(h(),E("div",null,[g(kt,{parentSelector:".left",expendWidth:200,shrinkWidth:50,expendIcon:"icon-jiantoushangzuo-copy",shrinkIcon:"icon-jiantouyou",position:"right"}),g(o(bt),{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=d=>n.value=d),stretch:!0,lazy:!0},{default:_(()=>[g(o(je),{label:"\u7EC4\u4EF6",name:"component"},{default:_(()=>[g(fa)]),_:1}),g(o(je),{label:"\u56FE\u5C42",name:"layer"},{default:_(()=>[g(ba)]),_:1})]),_:1},8,["modelValue"])]))}});var wa=T(Sa,[["__scopeId","data-v-751bba6c"]]);const Da={class:"home"},Ea={class:"left"},ka={class:"center scrollbar"},$a={class:"right"},Fa=U({setup(e){const n=z(),t=Ve(),s=Te("canvasData","",window==null?void 0:window.localStorage),d=Te("canvasStyle","",window==null?void 0:window.localStorage),a=w(null),p=Y({type:"dashed",width:1,color:"red"}),i=vt();Ee(()=>xe(this,null,function*(){let C="";i.params.index&&(C=i.params.index),t.clearSnapshot(),n.clearCanvas(),C&&(yield c(C))}));const c=C=>xe(this,null,function*(){const k=yield on(C);!k||(t.recordSnapshot(),n.setLayoutData(k))}),u=C=>{C.preventDefault(),C.stopPropagation();const k=C.dataTransfer.getData("componentName");if(k){const A=Fe(_e[k].component);A.style.top=C.offsetY,A.style.left=C.offsetX,t.recordSnapshot(),n.addComponent({component:A})}},r=C=>{C.preventDefault(),C.dataTransfer.dropEffect="copy"},m=()=>{n.setClickComponentStatus(!1)},l=()=>{n.isClickComponent||n.setCurComponent(null,void 0)},v=()=>{s.value&&n.setComponentData(JSON.parse(s.value)),d.value&&n.setCanvasStyle(JSON.parse(d.value))};ye(()=>n.canvasStyleData.dataWs,C=>{var k;(k=a.value)==null||k.close(),C&&(a.value=f("actual",C))});const f=(C,k)=>{const A=new WebSocket(k);return A.onopen=()=>{console.log("websocket\u8FDE\u63A5\u6210\u529F")},A.onclose=()=>{console.log("websocket\u8FDE\u63A5\u88AB\u5173\u95ED")},A.onmessage=I=>{const Z=JSON.parse(I.data);Ne.emit(C,Z)},A};return Be(()=>{var C;(C=a.value)==null||C.close()}),(C,k)=>(h(),E("div",Da,[g($o,{onRecovery:v}),D("main",null,[D("section",Ea,[g(wa)]),D("section",ka,[g(Vo,{borderStyle:o(p)},{default:_(()=>[D("div",{class:"content scrollbar",onDrop:u,onDragover:r,onMousedown:m,onMouseup:l},[g(Gn)],32)]),_:1},8,["borderStyle"])]),D("section",$a,[g(pa)])])]))}});var Ga=T(Fa,[["__scopeId","data-v-1aae74d1"]]);export{Ga as default};
